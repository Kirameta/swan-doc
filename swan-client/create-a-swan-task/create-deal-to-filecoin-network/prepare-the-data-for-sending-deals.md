# Prepare data for sending deals

### Create Car Files

üîî The input dir and out dir should only be absolute one.

üîî This step is necessary for both public and private tasks. You can choose one of the following 3 options.

#### Option1Ô∏è‚É£ By lotus web json RPC API

üîî This option will generate a car file for each file in the source directory.

```
./swan-client car -input-dir [input_files_dir] -out-dir [car_files_output_dir]
```

**Command parameters used in this step:**

* \-input-dir(Required): The directory where the source files reside in.
* \-out-dir(optional): Car files and metadata files will be generated into this directory. When omitted, use `[sender].output_dir` in [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)

**Configurations used in this step:**

* \[lotus].client\_api\_url, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[lotus].client\_access\_token, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[sender].output\_dir, only used when -out-dir is omitted in command, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[sender].generate\_md5, when it is true, then generate md5 for source files and car files, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)

**Files generated after this step:**

* car.csv: contains information for both source files and car files
* car.json: contains information for both source files and car files, see [Offline Deal](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Offline-Deal)
* \[source-file-name].car: each source file has a related car file

#### Option2Ô∏è‚É£ By graphsplit API

üîî This option can split a file under the source directory to one or more car file(s) in the output directory.

```
./swan-client gocar -input-dir [input_files_dir] -out-dir [car_files_output_dir]
```

**Command parameters used in this step:**

* \-input-dir(Required): The directory where the source files reside in.
* \-out-dir(optional): Car files and metadata files will be generated into this directory. When omitted, use `[sender].output_dir` in [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)

**Configurations used in this step:**

* \[lotus].client\_api\_url, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[lotus].client\_access\_token, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[sender].gocar\_file\_size\_limit, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[sender].gocar\_folder\_based, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[sender].output\_dir, only used when -out-dir is omitted in command, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[sender].generate\_md5, when it is true, then generate md5 for source files and car files, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)

**Files generated after this step:**

* manifest.csv: this is generated by `graphsplit api`
* car.csv: contains information for both source files and car files, generated from `manifest.csv`
* car.json: contains information for both source files and car files, see [Offline Deal](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Offline-Deal), generated from `manifest.csv`
* \[hash-value-of-file-part].car: if `gocar_folder_based=true`, the folder will have one or more car files, otherwise each source file has one or more related car file(s), according to its size and `[sender].gocar_file_size_limit`

**Note:**

* If the source file size is greater than `[sender].gocar_file_size_limit`, the source file information in the metadata files is for temporary source files, which are generated by `graphsplit api`, and after the car files are generated, those temporary source files will be deleted by `graphsplit api`. And in this condition, we do not create source file MD5 in the metadata files.

Credits should be given the filedrive-team. More information can be found at [https://github.com/filedrive-team/go-graphsplit](https://github.com/filedrive-team/go-graphsplit).

#### Option3Ô∏è‚É£ By IPFS API

üîî This option will merge files under the source directory to one car file in the output directory.

```
./swan-client ipfscar -input-dir [input_files_dir] -out-dir [car_file_output_dir]
```

**Command parameters used in this step:**

* \-input-dir(Required): The directory where the source files reside in.
* \-out-dir(optional): Car file and metadata files will be generated into this directory. When omitted, use `[sender].output_dir` in [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)

**Configurations used in this step:**

* \[lotus].client\_api\_url, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[lotus].client\_access\_token, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[sender].output\_dir, only used when -out-dir is omitted in command, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[sender].generate\_md5, when it is true, then generate md5 for source files and car files, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)
* \[ipfs\_server].upload\_url\_prefix, see [Configuration](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Configuration)

**Files generated after this step:**

* car.csv: contains information for car file
* car.json: contains information for car file, see [Offline Deal](https://github.com/filswan/go-swan-client/tree/release-v0.1.0-rc1#Offline-Deal)
* \[car-file-cid].car: the file(s) will be merged into a car file

**Note:** We do not create source file MD5 in the metadata files.
